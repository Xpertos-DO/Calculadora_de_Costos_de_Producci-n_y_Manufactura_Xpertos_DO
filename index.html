<!--
PROYECTO: Calculadora de Costos de Producción (Xpertos)
OBJETIVO: Herramienta gratuita para emprendedores: costos de materiales, electricidad, gas y tiempo.

Estructura de archivos (buenas prácticas):
- css/base.css               → Variables, tipografías, estilos base e inputs
- css/layout.css             → Estructura general (header, contenedor)
- css/components.css         → Cards, botones, resultado, toast, colapsables
- css/table-materiales.css   → Estilos responsive específicos de la tabla de Materiales
- css/responsive.css         → Ajustes responsive generales
- js/ui.js                   → Utilidades de interfaz (validación, toast, limpiar, copiar, colapsables)
- js/calculos.js             → Cálculos (electricidad, gas, mano de obra) + factores de conversión
- js/materiales.js           → CRUD de filas de Materiales y conversión de unidades
- js/main.js                 → Actualización del resumen global

Orden recomendado de CSS (respetar cascada):
1) base → 2) layout → 3) components → 4) table-materiales → 5) responsive

Orden recomendado de JS (dependencias):
1) ui.js → 2) materiales.js → 3) calculos.js → 4) main.js

Checklist de desarrollo:
- Mantener IDs/Clases del DOM si cambias estilos o estructura (los scripts dependen de ellos).
- Antes de refactorizar funciones, documentar inputs/outputs y actualizar comentarios.
- Probar en móvil (<600px) y escritorio (>1024px).
- Evitar dependencias externas para mantener compatibilidad con GitHub Pages.

-->
<!DOCTYPE html>
<html lang="es">
<link rel="stylesheet" href="css/base.css" />
<link rel="stylesheet" href="css/layout.css" />
<link rel="stylesheet" href="css/components.css" />
<link rel="stylesheet" href="css/table-materiales.css" />
<link rel="stylesheet" href="css/responsive.css" />
<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Calculadora de costos de producción: electricidad, gas y mano de obra por lote o producto." />
  <title>Calculadora de Costos de Producción</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>

<header>
  <img src="img/xpertos_blanco.png" alt="Logo de Xpertos" />
  <h1>Calculadora de Costos de Producción</h1>
  <p>Conversión de unidades, costo eléctrico, GLP y mano de obra por lote de producto</p>
</header>

<main class="container" role="main">

  <!-- MATERIALES (Masa) -->
  <section class="card" id="card-materiales" aria-labelledby="materiales-title">
    <h3 id="materiales-title" class="collapse-btn" tabindex="0" role="button" aria-expanded="true" aria-controls="collapse-materiales"
        onclick="toggleCollapse('collapse-materiales')" onkeydown="if(event.key==='Enter'||event.key===' ')toggleCollapse('collapse-materiales')">
       Materiales 
    </h3>
    <div id="collapse-materiales" class="collapse-content show">

      <div id="contenedorMateriales">
    <table id="tablaMateriales" style="width:100%;border-collapse:collapse;">
    
          <thead>
            <tr style="color:var(--muted);text-align:left;">
              <th>Producto</th>
              <th>Cantidad compra</th>
              <th>Unidad compra</th>
              <th>Precio total</th>
              <th>Unidad transformación</th>
              <th>Cantidad equivalente</th>
              <th>Costo por unidad</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <button class="calc" type="button" onclick="agregarMaterial()">+ Agregar material</button>
      <div class="result" aria-live="polite" id="resultadoMateriales">
        <span class="result-text">Subtotal materiales: $0.00</span>
      </div>
    </div>
  </section>

  <!-- ELECTRICIDAD -->
  <section class="card" id="card-electricidad" aria-labelledby="electricidad-title">
    <h3 id="electricidad-title" class="collapse-btn" tabindex="0" role="button" aria-expanded="true" aria-controls="collapse-electricidad"
        onclick="toggleCollapse('collapse-electricidad')" onkeydown="if(event.key==='Enter'||event.key===' ')toggleCollapse('collapse-electricidad')">
       Electricidad
    </h3>
    <div id="collapse-electricidad" class="collapse-content show">
    <div class="table-responsive">
      <label for="potencia">Consumo del equipo (W)
      <input id="potencia" type="number" min="0" step="1" placeholder="Ej: Potencia que consume el equipo, en Watts 300 (ver etiqueta o manual)" aria-describedby="potenciaHelp" />
      </label>
      <label for="tiempoUsoElect">Duración de un lote (h)</label>
      <input id="tiempoUsoElect" type="number" min="0" step="0.01" placeholder="Tiempo que el equipo está encendido para producir un lote, en horas." aria-describedby="tiempoUsoElectHelp" />

      <label for="frecuencia">Lotes al mes</label>
      <input id="frecuencia" type="number" min="0" step="1" placeholder="Cantidad de lotes que produces en un mes." aria-describedby="frecuenciaHelp" />

      <label for="precioKwh">Costo por kWh de electricidad</label>
      <input id="precioKwh" type="number" min="0" step="0.0001" placeholder="Precio por kWh según tu factura de electricidad." aria-describedby="precioKwhHelp" />
      </div>
      <div class="hint">Fórmula: (W × horas × lotes) ÷ 1000 × costo kWh</div>
      <button class="calc" type="button" onclick="calcularElectricidad()">Calcular Electricidad</button>
      <div class="result" aria-live="polite" id="resultadoElect">
        <span class="result-text"></span>
        <div class="button-group" style="display:none;">
          <button class="copy" type="button" aria-label="Copiar resultado" onclick="copiarResultado('resultadoElect')">Copiar</button>
          <button class="clear" type="button" aria-label="Limpiar sección" onclick="limpiarSeccion('electricidad')">Limpiar</button>
        </div>
      </div>
    </div>
  </section>

  <!-- GAS -->
  <section class="card" id="card-gas1" aria-labelledby="gas-title">
    <h3 id="gas-title" class="collapse-btn" tabindex="0" role="button" aria-expanded="true" aria-controls="collapse-gas1"
        onclick="toggleCollapse('collapse-gas1')" onkeydown="if(event.key==='Enter'||event.key===' ')toggleCollapse('collapse-gas1')">
       Gas (GLP)
    </h3>
    <div id="collapse-gas1" class="collapse-content show">
    <div class="table-responsive">
      <label for="btuCilindro1">Capacidad total de gas del cilindro (BTU)
      <input id="btuCilindro1" type="number" min="0" step="1" value="91500" placeholder="Valor típico para cilindro de 25 lb: 91,500 BTU." aria-describedby="btuCilindroHelp" />
      </label>
      <label for="btuQuemador1">Potencia del quemador (BTU/h)</label>
      <select id="btuQuemador1" aria-describedby="btuQuemadorHelp">
        <option value="">-- Selecciona quemador --</option>
        <option value="5000">Pequeño: 5,000–8,000 BTU/h</option>
        <option value="9000">Mediano: 9,000–12,000 BTU/h</option>
        <option value="15000">Grande: 15,000–18,000 BTU/h</option>
      </select>

      <label for="tiempoUsoGas1">Duración de uso del quemador por lote (h)</label>
      <input id="tiempoUsoGas1" type="number" min="0" step="0.01" placeholder="Tiempo que el quemador está encendido para un lote." aria-describedby="tiempoUsoGasHelp" />

      <label for="precioCilindro1">Costo de llenado del cilindro</label>
      <input id="precioCilindro1" type="number" min="0" step="0.01" placeholder="Precio que pagas por rellenar o cambiar el cilindro." aria-describedby="precioCilindroHelp" />
      </div>
      <div class="hint">Fórmula: (BTU/h × horas) ÷ BTU cilindro × costo cilindro</div>
      <button class="calc" type="button" onclick="calcularGas(1)">Calcular Gas</button>
      <div class="result" aria-live="polite" id="resultadoGas1">
        <span class="result-text"></span>
        <div class="button-group" style="display:none;">
          <button class="copy" type="button" aria-label="Copiar resultado" onclick="copiarResultado('resultadoGas1')">Copiar</button>
          <button class="clear" type="button" aria-label="Limpiar sección" onclick="limpiarSeccion('gas1')">Limpiar</button>
        </div>
      </div>
    </div>
  </section>

  <!-- TIEMPO -->
  <section class="card" id="card-tiempo" aria-labelledby="tiempo-title">
    <h3 id="tiempo-title" class="collapse-btn" tabindex="0" role="button" aria-expanded="true" aria-controls="collapse-tiempo"
        onclick="toggleCollapse('collapse-tiempo')" onkeydown="if(event.key==='Enter'||event.key===' ')toggleCollapse('collapse-tiempo')">
       Tiempo de trabajo
    </h3>
    <div id="collapse-tiempo" class="collapse-content show">
    <div class="table-responsive">
      <label for="tiempoLoteMin">Duración total de producción por lote (min)
      <input id="tiempoLoteMin" type="number" min="0" step="0.1" placeholder="Incluye preparación, cocción y empaquetado." aria-describedby="tiempoLoteMinHelp" />
        </label>
      <label for="cantidadProductos">Unidades producidas por lote</label>
      <input id="cantidadProductos" type="number" min="1" step="1" placeholder="Cantidad de piezas o productos terminados en un lote." aria-describedby="cantidadProductosHelp" />

      <label for="salarioHora">Costo por hora de mano de obra</label>
      <input id="salarioHora" type="number" min="0" step="0.01" placeholder="Lo que te pagas a ti mismo o a un trabajador por hora." aria-describedby="salarioHoraHelp" />
      </div>
      <div class="hint">Fórmula por producto: (min ÷ 60 ÷ unidades) × costo/hora</div>
      <button class="calc" type="button" onclick="calcularTiempo()">Calcular Tiempo</button>
      <div class="result" aria-live="polite" id="resultadoTiempo">
        <span class="result-text"></span>
        <div class="button-group" style="display:none;">
          <button class="copy" type="button" aria-label="Copiar resultado" onclick="copiarResultado('resultadoTiempo')">Copiar</button>
          <button class="clear" type="button" aria-label="Limpiar sección" onclick="limpiarSeccion('tiempo')">Limpiar</button>
        </div>
      </div>
    </div>
  </section>

  <!-- RESUMEN -->
  <section class="card" id="card-resumen" aria-labelledby="resumen-title">
    <h3 id="resumen-title" class="collapse-btn" tabindex="0" role="button" aria-expanded="true" aria-controls="collapse-resumen"
        onclick="toggleCollapse('collapse-resumen')" onkeydown="if(event.key==='Enter'||event.key===' ')toggleCollapse('collapse-resumen')">
       Resumen de Subtotales
    </h3>
    <div id="collapse-resumen" class="collapse-content show">
  
      <table id="tablaResumen" style="width:100%;border-collapse:collapse;">
        <thead>
          <tr style="color:var(--muted);text-align:left;">
            <th>Concepto</th>
            <th>Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Materiales</td>
            <td id="subtotalMateriales">
              <div id="listaMateriales">Sin materiales calculados</div>
            </td>
          </tr>
          <tr>
            <td>Electricidad</td>
            <td id="subtotalElect">$0.00</td>
          </tr>
          <tr>
            <td>Gas</td>
            <td id="subtotalGas">$0.00</td>
          </tr>
          <tr>
            <td>Mano de obra</td>
            <td id="subtotalTiempo">$0.00</td>
          </tr>
          <tr style="font-weight:700; border-top:1px solid var(--stroke);">
            <td>Total</td>
            <td id="totalFinal">$0.00</td>
          </tr>
        </tbody>
      </table>
  
      <button class="calc" type="button" onclick="actualizarResumen()">Actualizar Resumen</button>
    </div>
  </section>

</main>

<!-- Notificación visual -->
<div id="toast" class="toast" role="status" aria-live="polite"></div>

<!-- Scripts -->
<script src="js/ui.js"></script>
<script src="js/materiales.js"></script>
<script src="js/calculos.js"></script>
<script src="js/main.js"></script>

</body>
</html>
